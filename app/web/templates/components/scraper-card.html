<div class="scraper-card"
     id="scraper-{{ scraper.name }}"
     hx-get="{{ url_for('scrapers.scraper_card', name=scraper.name) }}"
     hx-trigger="every 5s"
     hx-swap="outerHTML">
    <div class="scraper-header">
        <h3>{{ scraper.name }}</h3>
        <span class="status-badge status-{{ scraper.status }}">{{ scraper.status }}</span>
    </div>
    <p class="scraper-description">{{ scraper.description }}</p>
    <div class="scraper-stats">
        <span>Processed: {{ scraper.state.processed_count if scraper.state else 0 }}</span>
        {% if scraper.state and scraper.state.last_updated %}
        <span>Last run: {{ scraper.state.last_updated[:10] }}</span>
        {% endif %}
    </div>
    <div class="scraper-actions">
        {% if scraper.status == 'running' or scraper.status == 'cancelling' %}
        <button class="btn btn-danger"
                hx-post="{{ url_for('scrapers.cancel_scraper', name=scraper.name) }}"
                hx-target="#scraper-{{ scraper.name }} .status-badge"
                hx-swap="outerHTML"
                {% if scraper.status == 'cancelling' %}disabled{% endif %}>
            {% if scraper.status == 'cancelling' %}Cancelling...{% else %}Cancel{% endif %}
        </button>
        {% else %}
        <button class="btn btn-primary"
                hx-post="{{ url_for('scrapers.run_scraper', name=scraper.name) }}"
                hx-target="#scraper-{{ scraper.name }}"
                hx-swap="outerHTML">
            Run Now
        </button>
        {% endif %}
        <a href="{{ url_for('scrapers.scrapers_page') }}" class="btn btn-secondary">Configure</a>
    </div>
</div>
